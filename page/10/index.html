<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.7.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.liaochuntao.cn","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="励志成为一位大佬">
<meta property="og:type" content="website">
<meta property="og:title" content="春少 Blog">
<meta property="og:url" content="https://www.liaochuntao.cn/page/10/index.html">
<meta property="og:site_name" content="春少 Blog">
<meta property="og:description" content="励志成为一位大佬">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="春少 Blog">
<meta name="twitter:description" content="励志成为一位大佬">

<link rel="canonical" href="https://www.liaochuntao.cn/page/10/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'default'
  };
</script>

  <title>春少 Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">春少 Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2018/01/29/machine-learning-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/29/machine-learning-1/" class="post-title-link" itemprop="url">机器学习之knn</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-29 11:46:35" itemprop="dateCreated datePublished" datetime="2018-01-29T11:46:35+08:00">2018-01-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index"><span itemprop="name">机器学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>机器学习很简单的入门——KNN近邻算法，这是一个用于将未知事物分类到已经事物分类中的算法。这个算法的原理其实很简单的，就是求两点之间的距离，通过距离大小的判断最为主要依据来判断得出未知事物与k个最相近的已知事物，在通过每个已知事物出现的标签次数，来决策出未知事物的最终分类结果。</p>
<p>再深入理解下knn，其实就是计算两事物的相似性程度，这其实是knn算法的本质——通过相似度来实现分类的功能；既然我们已经知道了knn算法的本质是计算相似性程度，那么我们就可以采用很多种方式来计算两者的相似程度了，比如我前文说的计算两个点之间的距离来计算相似度，就是计算欧式距离；我们还可以计算两个向量之间的余弦值来计算相似度，等等还有很多，具体的请点击链接 <a href="http://www.cnblogs.com/arachis/p/Similarity.html" target="_blank" rel="noopener">相似度计算</a> 。我最熟悉的就是一个欧拉距离，还有就是余弦相似度计算。</p>
<p>knn算法的具体步骤如下</p>
<ul>
<li>人工先进行分类，得出一个标准分类</li>
<li>对事物特征进行 one-hot编码，也就是向量化</li>
<li>对未知事物进行编码操作</li>
<li>计算未知事物与所有已知事物的空间距离</li>
<li>对距离从小到大排序，取出前k个距离最小的事物分类</li>
<li>计算这k个事物中所有便签的出现次数，标签出现次数最多的，为该未知事物的最终分类</li>
</ul>
<blockquote>
<p>knn算法的python实现</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classify</span><span class="params">(input_data, dataSet, lables, k)</span>:</span></span><br><span class="line">  dataSetSize = dataSet.shape[<span class="number">0</span>]</span><br><span class="line">  diffMat = np.tile(input_data, (dataSetSize, <span class="number">1</span>)) - dataSet</span><br><span class="line">  diffMat = diffMat ** <span class="number">2</span></span><br><span class="line">  sqDistance = diffMat.sum(axis = <span class="number">1</span>)</span><br><span class="line">  distance = sqDistance ** <span class="number">0.5</span></span><br><span class="line">  distance = distance.argsort()</span><br><span class="line">  classCount = &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">    voteLabel = lable[distance[i]]</span><br><span class="line">    classCount[voteLable] = classCount.get(voteLable, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">  classCount = sorted(classCount.iteritems(), key=operator.itemgetter(<span class="number">1</span>), reverse=<span class="keyword">True</span>)</span><br><span class="line">  <span class="keyword">return</span> classCount[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其中一些api的解释</p>
</blockquote>
<ul>
<li><p>np.tile(a, b)：a是待处理的对象，b是一个元组；假设有np.tile(1, (3, 2))，表示在行的方向上重复3次，列的方向上重复2次；最后结果如下<br><img src="http://120.24.90.180/blog/image/machine_learning/machine_learning_1.1.png" alt="np.tile()"></p>
</li>
<li><p>argsort()：argsort()函数返回的是数组值从小到大的索引值</p>
</li>
<li><p>sorted(iterable, cmp, key, reverse)：iterable是一个list对象或者是iterator；cmp是带两个参数的比较函数；key是带一个参数的比较函数；reverse是是否逆序；</p>
</li>
<li><p>operator.itemgetter()：是获取对象某个域值的函数，这个不是返回指，而是定义了一个函数</p>
</li>
</ul>
<blockquote>
<p>knn算法的实际演示</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createDataSet</span><span class="params">()</span>:</span></span><br><span class="line">  group = np.array([[<span class="number">1.0</span>, <span class="number">1.1</span>], [<span class="number">1.0</span>, <span class="number">1.0</span>], [<span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0.1</span>]])</span><br><span class="line">  lables = [<span class="string">'A'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'B'</span>]</span><br><span class="line">  <span class="keyword">return</span> group, lables</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">  group, lables = createDataSet()</span><br><span class="line">  input_data = [[<span class="number">1.1</span>, <span class="number">0.9</span>], [<span class="number">0.012</span>, <span class="number">0.01</span>], [<span class="number">0.989</span>, <span class="number">0.996</span>], [<span class="number">0.997</span>, <span class="number">1.003</span>]]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> input_data:</span><br><span class="line">    <span class="keyword">print</span> classify(i, group, lables, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果</p>
<p><img src="http://120.24.90.180/blog/image/machine_learning/machine_learning_1.2.png" alt="output_data_answer"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2018/01/23/leetcode_2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/23/leetcode_2/" class="post-title-link" itemprop="url">leetcode回顾——Two Sum 快速找到两个数字之和等于目标值</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-23 15:45:51" itemprop="dateCreated datePublished" datetime="2018-01-23T15:45:51+08:00">2018-01-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LeetCode/" itemprop="url" rel="index"><span itemprop="name">LeetCode</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天做了一题Leetcode的题目，是数组类型的题目，题目很短，也很简单</p>
<pre><code>Given an array of integers, return indices of the two numbers such that they add up to a specific target.
You may assume that each input would have exactly one solution, and you may not use the same element twice.
Example:
Given nums = [2, 7, 11, 15], target = 9,
Because nums[0] + nums[1] = 2 + 7 = 9,
return [0, 1].
</code></pre><p>这道题目就是让你在一个数组中找到两个数，这两个数的和必须等于目标值，如果采用暴力法，那么时间复杂度将会是O（N^2）级别。这会导致超时的结果。那么该如何做呢？如果把这个题目的两个未知数转为一个未知数，那么会不会更简单些呢？这是肯定的，两个未知数求一个数，倒不如利用结果和一个未知数，求另一个未知数。因此我们只需要利用减法操作就可以快速求解</p>
<blockquote>
<p>我们利用目标值减去数组的每一个值，并判断差存不存在数组中，若存在，则就得到了答案；我们利用python的字典数据结构来作为中间存储。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums, target)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums: list[int]</span></span><br><span class="line"><span class="string">        :type target: int</span></span><br><span class="line"><span class="string">        :rtype: list[int]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        hash = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            <span class="keyword">if</span> target - nums[i] <span class="keyword">in</span> hash:</span><br><span class="line">                <span class="keyword">return</span> [hash[target - nums[i]], i]</span><br><span class="line">            hash[nums[i]] = i</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    s = Solution()</span><br><span class="line">    <span class="keyword">print</span> s.twoSum([<span class="number">3</span>, <span class="number">3</span>], <span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p>这是其中一种最快的方法，还有一种方法的时间复杂度是O（NlogN）级别的，这个方法的时间开销主要在于排序操作：</p>
<blockquote>
<p>我们将数组进行排序操作，得到从小到大的序列，然后从数组最左边和最右边进行两个数的相加，如果大于目标值，我们把右边指向的位置向左移动一位，如果小于目标值，我们就把左边指向的位置向右移动一位；但是，这个方法由于排序了，势必将原先的顺序打乱，因此我们还需要利用一个方法记住原先的位置信息，可以利用一个数据结构来存储，也可以利用中间量复制一份数组，在复制的数组进行排序操作，再来获取原先数据的位置</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums, target)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums: list[int]</span></span><br><span class="line"><span class="string">        :type target: int</span></span><br><span class="line"><span class="string">        :rtype: list[int]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        tmp_nums = [i <span class="keyword">for</span> i <span class="keyword">in</span> nums]</span><br><span class="line">        tmp_nums.sort()</span><br><span class="line">        max_loc = len(nums) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(tmp_nums)):</span><br><span class="line">            <span class="keyword">if</span> tmp_nums[i] &gt;= target:</span><br><span class="line">                max_loc = i</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        l, r = <span class="number">0</span>, max_loc</span><br><span class="line">        <span class="keyword">while</span> l &gt; r:</span><br><span class="line">            ans = tmp_nums[l] + tmp_nums[r]</span><br><span class="line">            <span class="keyword">if</span> ans == target:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> ans &gt; target:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">        l = nums.index(tmp_nums[l])</span><br><span class="line">        nums[l] = <span class="number">-1</span></span><br><span class="line">        r = nums.index(tmp_nums[r])</span><br><span class="line">        <span class="keyword">return</span> [nums.index(tmp_nums[l]), nums.index(tmp_nums[r])]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    s = Solution()</span><br><span class="line">    <span class="keyword">print</span> s.twoSum([<span class="number">3</span>, <span class="number">3</span>], <span class="number">6</span>)</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2018/01/20/data_struct_16/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/20/data_struct_16/" class="post-title-link" itemprop="url">Bloom Filter</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-20 14:28:25" itemprop="dateCreated datePublished" datetime="2018-01-20T14:28:25+08:00">2018-01-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这两天看了下爬虫的技术，其中，爬虫有一项很重要的注意事项——过滤掉已经爬取过的URL地址。那么，这个过滤要怎么实现呢？参照之前的文章，或许我们可以维护两个队列，一个队列为保存已经访问过的URL地址，另一个队列为保存尚待爬取的URL地址，这样我们只需要把将要爬取URL地址去一访问的URL地址队列中查找，如果存在，那么就将这个URL地址入队到待爬取URL地址的队列中去。这样感觉很完美，但是，这样的时间开销对于大型爬虫程序是难以承受的，队列的查找再怎么快都需要 O(log2N)[ 折半查找、插值查找、斐波那契查找 ]；这个时候Hash表查找或许会是一个不错的方案，我们用一个数组来存储URL地址信息，如果这个URL爬取了，那么我们将这个URL地址利用Hash表存储，届时如果我们需要查找某一个URL地址是否被访问过，只要需要利用Hash查找，几乎可以在 O(1) 的时间开销内查找到结果，但是呢，这还是不够，就有了今天说要讲的数据结构—— <a href="https://zh.wikipedia.org/wiki/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8" target="_blank" rel="noopener"><code>Bloom Filter</code></a></p>
<p><img src="http://120.24.90.180:8080/blog/image/data_struct/data_struct_16.png" alt="data_struct_16"></p>
<p><code>Bloom Filter</code>其实原理其实就是Hash散列表，只不过由一个Hash函数转为多个Hash函数，并且不需要存储实际URL地址数据。那么<code>Bloom Filter</code>是如何实现的呢？<code>Bloom Filter</code>是利用K个互不相关的Hash函数以及一个长度为m，默认值为0的位数组，通过将长度为l的数组s中的每一个元素映射到位数组中去，只要被映射到，那么位数组对应的数据就变为1，这就是<code>Bloom Filter</code>的实现，查找的时候，通过计算并查看对应位数组中的值是1还是0，如果都是1就代表元素存在，否则只要有一个0，就否定了该元素的存在性。</p>
<blockquote>
<p>Bloom Filter 代码实现</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="title">int</span> <span class="params">(*hash_func_p)</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>*)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tagBloom</span> &#123;</span></span><br><span class="line"> <span class="keyword">unsigned</span> <span class="keyword">int</span> length;	<span class="comment">// 缓冲区长度</span></span><br><span class="line"> <span class="keyword">char</span>* buffer;</span><br><span class="line"> <span class="keyword">unsigned</span> <span class="keyword">int</span> func_n;	<span class="comment">// hash函数个数</span></span><br><span class="line"> hash_func_p* func_p;	<span class="comment">// 函数指针数组</span></span><br><span class="line">&#125; Bloom;</span><br><span class="line"></span><br><span class="line"><span class="function">Bloom* <span class="title">create_bloom</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> length, <span class="keyword">unsigned</span> <span class="keyword">int</span> func_n, ...)</span> </span>&#123;</span><br><span class="line"> Bloom* b = <span class="literal">NULL</span>;</span><br><span class="line"> va_list l;</span><br><span class="line"> <span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 申请内存</span></span><br><span class="line"> <span class="keyword">if</span>(!(b = (Bloom*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Bloom))))</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"> <span class="keyword">if</span>(!(b-&gt;buffer = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>) * length))) &#123;</span><br><span class="line">  <span class="built_in">free</span>(b);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>(!(b-&gt;func_p = (hash_func_p*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(hash_func_p) * func_n))) &#123;</span><br><span class="line">  <span class="built_in">free</span>(b-&gt;buffer);</span><br><span class="line">  <span class="built_in">free</span>(b);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(b-&gt;buffer, <span class="number">0</span>, length * <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">	</span><br><span class="line">	va_start(l, func_n);</span><br><span class="line"> <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; func_n; ++i) &#123;</span><br><span class="line">  *(b-&gt;func_p + i) = va_arg(l, hash_func_p);</span><br><span class="line"> &#125;</span><br><span class="line"> va_end(l);</span><br><span class="line"></span><br><span class="line">	b-&gt;length = length * <span class="keyword">sizeof</span>(<span class="keyword">char</span>);</span><br><span class="line"> b-&gt;func_n = func_n;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">destroy_bloom</span><span class="params">(Bloom *b)</span> </span>&#123;</span><br><span class="line"> <span class="built_in">free</span>(b-&gt;buffer);</span><br><span class="line"> <span class="built_in">free</span>(b-&gt;func_p);</span><br><span class="line"> <span class="built_in">free</span>(b);</span><br><span class="line"> b = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set_bit</span><span class="params">(<span class="keyword">char</span> *buf, <span class="keyword">unsigned</span> <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"> buf[n &gt;&gt; <span class="number">3</span>] |= <span class="number">1</span> &lt;&lt; (n &amp; <span class="number">7</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_bit</span><span class="params">(<span class="keyword">char</span> *buf, <span class="keyword">unsigned</span> <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> (buf[n &gt;&gt; <span class="number">3</span>] &amp; (<span class="number">1</span> &lt;&lt; (n &amp; <span class="number">7</span>)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_record</span><span class="params">(Bloom *b, <span class="keyword">const</span> <span class="keyword">char</span>* str)</span> </span>&#123;</span><br><span class="line"> <span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">for</span>(	; i &lt; b-&gt;func_n; ++i) &#123;</span><br><span class="line">  set_bit(b-&gt;buffer, (*(b-&gt;func_p + i))(str) % b-&gt;length);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check_record</span><span class="params">(Bloom *b, <span class="keyword">const</span> <span class="keyword">char</span>* str)</span> </span>&#123;</span><br><span class="line"> <span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">for</span>(	; i &lt; b-&gt;func_n; ++i)</span><br><span class="line">  <span class="keyword">if</span>(!get_bit(b-&gt;buffer, (*(b-&gt;func_p + i))(str) % b-&gt;length))</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Hash函数的实现</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"hash.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">bkdr_hash</span><span class="params">(<span class="keyword">char</span> *str)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> seed = <span class="number">13131</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> hash = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(*str)</span><br><span class="line">		hash = hash * seed + (*str++);</span><br><span class="line">	<span class="keyword">return</span> (hash &amp; <span class="number">0x7fffffff</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">ap_hash</span><span class="params">(<span class="keyword">char</span> *str)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> hash = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(*str) &#123;</span><br><span class="line">		<span class="keyword">if</span>((i &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">			hash ^= ((hash &lt;&lt; <span class="number">7</span>) ^ (*str++) ^ (hash &gt;&gt; <span class="number">3</span>));</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			hash ^= (~((hash &lt;&lt; <span class="number">11</span>) ^ (*str++) ^ (hash &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">		++i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> (hash &amp; <span class="number">0x7fffffff</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">djb_hash</span><span class="params">(<span class="keyword">char</span> *str)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> hash = <span class="number">5381</span>;</span><br><span class="line">	<span class="keyword">while</span>(*str)</span><br><span class="line">		hash += (hash &lt;&lt; <span class="number">5</span>) + (*str++);</span><br><span class="line">	<span class="keyword">return</span> (hash &amp; <span class="number">0x7fffffff</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2018/01/18/java_web_2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/18/java_web_2/" class="post-title-link" itemprop="url">Java原生代码实现简易版爬虫</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-18 15:36:10" itemprop="dateCreated datePublished" datetime="2018-01-18T15:36:10+08:00">2018-01-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java-web/" itemprop="url" rel="index"><span itemprop="name">java-web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>爬虫这个操作，应该都听说过吧，更多的应该是听过Python进行爬虫操作，但是身为主攻Java的人，怎么可以不用Java来实现爬虫呢？趁着期末考试的时间，用Java原生实现了非常简单的爬虫代码，没有采用任何第三方jar包。<br><br>先来简要说一说什么是爬虫吧：爬虫就是一个网络机器人，它通过url地址浏览网页，并将所浏览过的信息保存起来。如果一个页面中有许多url地址信息，那么爬虫会先将这些url地址存储在一个工作队列中，待完成当前爬取信息工作后再从工作队列中获取下一个带爬取信息的url信息，重复刚刚的步骤。<br></p>
<blockquote>
<p>现在来进入正题——如何用Java原生代码实现简易的爬虫</p>
</blockquote>
<p>假设我们现在有这样的一个网页</p>
<p><img src="http://120.24.90.180/blog/image/java_web/java_web_2_1.png" alt="java_web_2_1.png"></p>
<p>我希望能够将这道菜的名称以及做法步骤仅仅以文字信息保存下来。我们先看下这个网页的源代码</p>
<p><img src="http://120.24.90.180/blog/image/java_web/java_web_2_2.png" alt="java_web_2_2.png"></p>
<p>从源代码可以看出，菜名和步骤在<code>&lt;h2 id=&quot;steps&quot;&gt;&lt;/h2&gt;</code>和<code>&lt;div class=&quot;steps&quot;&gt;&lt;/div&gt;</code>这两个html标签之中，所以我们希望爬虫可以将这两个标签内的内容存储起来，这个时候，就可以用上正则表达式</p>
<p><code>Pattern urlPattern = compile(&quot;&lt;h2 id=\&quot;steps\&quot;&gt;.+?&lt;/h2&gt;.+?&lt;div class=\&quot;steps\&quot;&gt;.+?&lt;/div&gt;&quot;);</code></p>
<p>这样，我们就能够在整个页面的代码中，截取到了我们目标信息——菜品名以及做菜步骤。我们截取到的html代码如下<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">id</span>=<span class="string">"steps"</span>&gt;</span></span><br><span class="line">      家常小炒扇贝肉的做法 &amp;nbsp;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"steps"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">itemprop</span>=<span class="string">"recipeInstructions"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text"</span> &gt;</span>新鲜扇贝洗净，用清水泡半小时<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://s2.cdn.xiachufang.com/015b030b7e5245219d9d0afe8cddd4bd_640w_428h.jpg?imageView2/2/w/300/interlace/1/q/90"</span> <span class="attr">alt</span>=<span class="string">"家常小炒扇贝肉的做法 步骤1"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">itemprop</span>=<span class="string">"recipeInstructions"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text"</span> &gt;</span>葱姜蒜改刀切丝、辣椒切小段<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://s2.cdn.xiachufang.com/52eff0fe10104c37b4f63883479d89c2_640w_428h.jpg?imageView2/2/w/300/interlace/1/q/90"</span> <span class="attr">alt</span>=<span class="string">"家常小炒扇贝肉的做法 步骤2"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">itemprop</span>=<span class="string">"recipeInstructions"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text"</span> &gt;</span>取小碗，放蚝油、酱油、1大匙清水调成料汁<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://s1.cdn.xiachufang.com/cf437c2aaf3c4a83941298fd432cd8d6_640w_428h.jpg@2o_50sh_1pr_1l_300w_90q_1wh"</span> <span class="attr">alt</span>=<span class="string">"家常小炒扇贝肉的做法 步骤3"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">itemprop</span>=<span class="string">"recipeInstructions"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text"</span> &gt;</span>水开后把扇贝过水煮一下，扒出肉待用<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://s2.cdn.xiachufang.com/e00073232c654908a78d9b0a740165c7_640w_428h.jpg?imageView2/2/w/300/interlace/1/q/90"</span> <span class="attr">alt</span>=<span class="string">"家常小炒扇贝肉的做法 步骤4"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">itemprop</span>=<span class="string">"recipeInstructions"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text"</span> &gt;</span>炒锅倒植物油，转中火，放葱姜蒜、小辣椒炒香<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://s2.cdn.xiachufang.com/62126eb57b10497bad8ffe4060a2907b_3456w_2304h.jpg?imageView2/2/w/300/interlace/1/q/90"</span> <span class="attr">alt</span>=<span class="string">"家常小炒扇贝肉的做法 步骤5"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">itemprop</span>=<span class="string">"recipeInstructions"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text"</span> &gt;</span>转大火，放焯过的扇贝肉，放之前调好的汁(步骤3)，<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://s2.cdn.xiachufang.com/4e9e64a4afac4a698e9c360c818a6a2e_640w_428h.jpg?imageView2/2/w/300/interlace/1/q/90"</span> <span class="attr">alt</span>=<span class="string">"家常小炒扇贝肉的做法 步骤6"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">itemprop</span>=<span class="string">"recipeInstructions"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"text"</span> &gt;</span>翻炒几下即可出锅<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://s2.cdn.xiachufang.com/3a03f11296f14258bc1708e0b9a83822_640w_428h.jpg?imageView2/2/w/300/interlace/1/q/90"</span> <span class="attr">alt</span>=<span class="string">"家常小炒扇贝肉的做法 步骤7"</span> <span class="attr">width</span>=<span class="string">"300"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>接下来，我们再进一步的分析这段html代码，发现做菜步骤信息实际上是存储在了<code>&lt;p class=&quot;text&quot; &gt;&lt;/p&gt;</code>之中，因此，最后，我们再运用一次正则表达式，获取真正我们想要获取的内容：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">FoodBook</span><span class="params">(String context)</span> </span>&#123;</span><br><span class="line">    steps = <span class="keyword">new</span> TreeSet&lt;&gt;();</span><br><span class="line">    Pattern pattern = Pattern.compile(<span class="string">"&lt;p class=\"text\" &gt;(.+?)&lt;/p&gt;"</span>);</span><br><span class="line">    Matcher matcher = pattern.matcher(context);</span><br><span class="line">    <span class="keyword">boolean</span> isFind = matcher.find();</span><br><span class="line">    <span class="keyword">while</span> (isFind) &#123;</span><br><span class="line">        steps.add(matcher.group(<span class="number">1</span>));</span><br><span class="line">        isFind = matcher.find();</span><br><span class="line">    &#125;</span><br><span class="line">    pattern = Pattern.compile(<span class="string">"&lt;h2 id=\"steps\"&gt;(.+?)&lt;/h2&gt;"</span>);</span><br><span class="line">    matcher = pattern.matcher(context);</span><br><span class="line">    <span class="keyword">if</span> (matcher.find()) &#123;</span><br><span class="line">        foodName = matcher.group(<span class="number">1</span>).replaceAll(<span class="string">" +"</span>, <span class="string">""</span>)</span><br><span class="line">                                   .replace(<span class="string">"&amp;nbsp;"</span>, <span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如何从这个代码中获取我们想要的内容是已经解决了，但是还有一个最重要的问题——如何去访问网页呢？也就是爬虫最重要的一步。这个其实在Java的<code>java.io.*</code>和<code>java.net.*</code>包中都已经实现了。我们所需要引用的包如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLConnection;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br></pre></td></tr></table></figure></p>
<p>看到了吧，在<code>java.net.*</code>包中有URL类和URLConnection类，这个两个类就是最重要的，通过这两个类的带有的方法，我们就可以轻松的实现访问url并获得网页内容的操作：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getContext</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    StringBuffer context = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    BufferedReader br = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        URL realUrl = <span class="keyword">new</span> URL(url);</span><br><span class="line">        URLConnection connection = realUrl.openConnection();</span><br><span class="line">        connection.connect();</span><br><span class="line">        br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(connection.getInputStream(), <span class="string">"UTF-8"</span>));</span><br><span class="line">        String tempLine;</span><br><span class="line">        <span class="keyword">while</span> ((tempLine = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            context.append(tempLine);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            br.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> context.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>首先我们有一个url的字符串，我们需要将这个字符串转为能够开启连接的URL对象，然后利用URL对象的<code>openConnection()</code>获得一个URLConnection对象，只有通过URLConnection对象的<code>.connect()</code>方法，才能算是真正的开始连接url操作进行访问；随后，我们利用输入输出流将网页信息存到缓冲输入输出流<code>BufferReader</code>中。这样，我们就成功的爬取到了对应url的网页信息。最后，我们只需要对内容进行正则匹配工作获得我们想要的内容即可<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;FoodBook&gt; <span class="title">getFoodBooks</span><span class="params">(String context)</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;FoodBook&gt; results = <span class="keyword">new</span> ArrayList&lt;FoodBook&gt;();</span><br><span class="line">    Pattern urlPattern = compile(<span class="string">"&lt;h2 id=\"steps\"&gt;.+?&lt;/h2&gt;.+?&lt;div class=\"steps\"&gt;.+?&lt;/div&gt;"</span>);</span><br><span class="line">    Matcher urlMatcher = urlPattern.matcher(context);</span><br><span class="line">    <span class="keyword">boolean</span> isFind = urlMatcher.find();</span><br><span class="line">    System.out.println(isFind);</span><br><span class="line">    <span class="keyword">while</span> (isFind) &#123;</span><br><span class="line">        results.add(<span class="keyword">new</span> FoodBook(urlMatcher.group()));</span><br><span class="line">        isFind = urlMatcher.find();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> results;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最后，我们就得到下面的结果</p>
<p><img src="http://120.24.90.180/blog/image/java_web/java_web_2_3.png" alt="java_web_2_3.png"></p>
<blockquote>
<p>哔哩哔哩站点查看运行视频</p>
</blockquote>
<p><a href="https://www.bilibili.com/video/av18444787/" target="_blank" rel="noopener">https://www.bilibili.com/video/av18444787/</a></p>
<blockquote>
<p>源代码地址</p>
</blockquote>
<p><a href="https://github.com/chuntaojun/Java-Spider" target="_blank" rel="noopener">https://github.com/chuntaojun/Java-Spider</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2018/01/09/java_web_6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/09/java_web_6/" class="post-title-link" itemprop="url">如何简单实现JDK的动态代理功能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-09 23:49:42" itemprop="dateCreated datePublished" datetime="2018-01-09T23:49:42+08:00">2018-01-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java-web/" itemprop="url" rel="index"><span itemprop="name">java-web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Spring框架有一个很重要的机制——代理机制，而这个机制是实现Spring一个重要编程思想——切面编程思想重要工具。</p>
<p>那么代理功能有什么用呢？假设我们有一个方法，我们想查看这个方法的执行性能与开销时间，我们是怎么做的呢？</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2017-12-29-13-51-38.png" alt="Screenshot from 2017-12-29 13-51-38"></p>
<p>可能大部分的人都会这样直接在方法内部加上这两句代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">System.out.println(<span class="string">"该方法消耗时间"</span> + (System.currentTimeMillis() - start));</span><br></pre></td></tr></table></figure></p>
<p>可能感觉这样子，才两行代码，没有什么大不了的，但是如果方法一多，需要对大多数的业务逻辑代码进行开销记录呢？那个就会增加无数的重复代码，而这些代码跟我们的业务逻辑是根本没有关系的，我们只是希望在这个方法执行的过程中能够记录其开销而已，并不想去破坏这个方法原有的代码结构。那么这个要怎么实现呢？这个其实就是依靠Java自带的代理机制来解决，其实Java的JDK就有类的动态代理功能，而这本质又依赖于Java中的反射机制来实现。</p>
<p>那么什么是代理机制呢？所谓代理，就是我把一切都弄好了，但是呢，我本身不去做这件事情，我把这件事情的实施交给别人，这就是代理机制；只不过现在是换成我们主动想要一个代理人去实施这个事情，而不是方法本身去实施；当目标方法准备执行时被我们的代理类拦截了下来，然后，由代理类自带的方法去间接执行目标方法，在这过程当中，就可以增加任何你想要做的事情：加入开销时间、记录每一时刻执行的方法的详细信息（方法名、参数名）等等；这样，你会发现，只需要一个代理类，就可以实现我们刚刚想对所有方法进行开销时间的记录操作，并且还能不断扩充我们想要实现的增强功能（附录：这个其实已经有一点点Spring的切面编程的意味了）</p>
<blockquote>
<p>代理类</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInvokationHandler</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> E target;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyInvokationHandler</span><span class="params">(E target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Long beginTime = System.currentTimeMillis();</span><br><span class="line">        Object returnValue = method.invoke(target, args);</span><br><span class="line">        System.out.println(<span class="string">"方法"</span> + method.getName() + <span class="string">"调用结束，耗时"</span>+ (System.currentTimeMillis() -beginTime));</span><br><span class="line">        <span class="keyword">return</span> returnValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>被代理的接口</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">proxyInterface</span> <span class="keyword">extends</span> <span class="title">ControlDatabase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    &lt;T&gt;<span class="function">ResultBean&lt;T&gt; <span class="title">query</span><span class="params">(Object o, String sql)</span> <span class="keyword">throws</span> SQLException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    &lt;T&gt;<span class="function">ResultBean&lt;T&gt; <span class="title">insert</span><span class="params">(PreparedStatement preparedStatement)</span> <span class="keyword">throws</span> SQLException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    &lt;T&gt;<span class="function">ResultBean&lt;T&gt; <span class="title">delete</span><span class="params">(PreparedStatement preparedStatement)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    &lt;T&gt;<span class="function">ResultBean&lt;T&gt; <span class="title">update</span><span class="params">(PreparedStatement preparedStatement)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>实现代理调用</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyProxy</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ControlDatabase controlDatabase;</span><br><span class="line">    <span class="keyword">private</span> InvocationHandler handler;</span><br><span class="line">    <span class="keyword">private</span> proxyInterface proxy;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyProxy</span><span class="params">(ControlDatabase controlDatabase)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.controlDatabase = controlDatabase;</span><br><span class="line">        handler = <span class="keyword">new</span> MyInvokationHandler&lt;&gt;(controlDatabase);</span><br><span class="line">        proxy = (proxyInterface) Proxy.newProxyInstance(proxyInterface.class.getClassLoader(),</span><br><span class="line">                <span class="keyword">new</span> Class[]&#123;proxyInterface.class&#125;, handler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> proxyInterface <span class="title">getProxy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> proxy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">messageImpl</span> <span class="keyword">implements</span> <span class="title">messageMap</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">ResultBean&lt;T&gt; <span class="title">queryCompyInfo</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        proxyInterface proxy = <span class="keyword">new</span> AdaperFactory(<span class="keyword">new</span> MysqlQuery()).getProxy();</span><br><span class="line">        Connection connection = proxy.getConnection();</span><br><span class="line">        String sql = <span class="string">"SELECT * FROM Lanmu WHERE Lname='公司介绍'"</span>;</span><br><span class="line">        Statement statement = connection.createStatement();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultBean(proxy.query(statement, sql).getData());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从实现代理调用的 MyProxy 这个类中我们可以看出，只要是继承了proxyInterface这个接口的类或者接口，都会被我们的代理类所拦截下来，进入代理的流程。让我们通过一个视频来了解下吧：</p>
<blockquote>
<p>YouTube站点</p>
</blockquote>
<p>[youtube <a href="https://www.youtube.com/watch?v=WVU7S8nD9NQ&amp;w=560&amp;h=315]" target="_blank" rel="noopener">https://www.youtube.com/watch?v=WVU7S8nD9NQ&amp;w=560&amp;h=315]</a></p>
<blockquote>
<p>哔哩哔哩站点</p>
</blockquote>
<p><a href="https://www.bilibili.com/video/av18146765/" target="_blank" rel="noopener">https://www.bilibili.com/video/av18146765/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2017/12/31/deep_learning_2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/31/deep_learning_2/" class="post-title-link" itemprop="url">深度学习初探一——奇偶数学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-12-31 20:11:48" itemprop="dateCreated datePublished" datetime="2017-12-31T20:11:48+08:00">2017-12-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/深度学习/" itemprop="url" rel="index"><span itemprop="name">深度学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>奇偶数判断，这个是不是太简单了，不就一个数去对2取取余数，如果余数为0，那么这个数为偶数，否则，这个数为奇数，用Python写的话代码就像这样：</p>
<pre><code>def fun(number):
    if number % 2 == 0:
        print &quot;这是偶数&quot;
    else:
        print &quot;这是奇数&quot;
</code></pre><p>但是，这个判断法则是我们知道的，我们人为的在编程中将判断规则告诉计算机，通过计算来判断一个数是奇数还是偶数。如果我们要只告诉计算机一些数中那些是奇数，那些是偶数，然后让它自己判断新的数据属于偶数还是奇数的话，你要怎么编程呢？这不，最近闲来无视，看了看深度学习的书，突然想试一下，用深度神经网络让计算机去学习奇偶数的特点，然后去判断新的数据是奇数还是偶数。</p>
<p>现在我们来讲重点！！！如何用深度神经网络来让计算机学习判断一个数的奇偶性。</p>
<blockquote>
<p>First Step</p>
</blockquote>
<p>我们要训练一个神经网络，总要有数据吧？现在，我们就来创造一些训练数据集，代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> pp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_data</span><span class="params">(number=<span class="number">10001</span>)</span>:</span></span><br><span class="line">    temp = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, number * <span class="number">2</span>)]</span><br><span class="line">    data, labels = [], []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> temp:</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            data.append([i, i % <span class="number">10</span>, <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data.append([i, i % <span class="number">10</span>, <span class="number">0</span>])</span><br><span class="line">    seclar = pp.MinMaxScaler(feature_range=(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">    data = seclar.fit_transform(data)</span><br><span class="line">    np.random.shuffle(data)</span><br><span class="line">    <span class="keyword">print</span> data</span><br><span class="line">    labels = data[:, <span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> data, labels</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    load_data()</span><br></pre></td></tr></table></figure></p>
<p>我们在这个py文件中导入了<a href="https://wizardforcel.gitbooks.io/ts-numpy-tut/content/" target="_blank" rel="noopener">numpy</a>包和<a href="https://morvanzhou.github.io/tutorials/machine-learning/sklearn/" target="_blank" rel="noopener">sklearn</a>包，这两个包是在深度学习中常用的到，numpy用于数据的处理方面，sklearn是一个机器学习模块。我们先通过python自带的列表生成式生成数据范围在[1，number]的list数据类型，然后通过np.array()将我们list对象转为numpy的核心对象ndarry，同时，我们也为每一个数生成标签，如果是偶数，那么这个数的labels是1，否则为0，这样我们就完成了数据集的构建，接下来我们看到这几段代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">seclar = pp.MinMaxScaler(feature_range=(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">data = seclar.fit_transform(data)</span><br><span class="line">np.random.shuffle(data)</span><br></pre></td></tr></table></figure></p>
<p>这几段代码什么意思呢？我们简要分析下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seclar = pp.MinMaxScaler(feature_range=(<span class="number">0</span>, <span class="number">1</span>))</span><br></pre></td></tr></table></figure></p>
<p>这行代码是设置了归一化，我们对numpy.ndarry的同一列数据进行归一化操作，所谓归一化就是将所有数据缩小到[0，1]的范围内，那么归一化的数学公式呢？看下图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new_num = (old_num - min_value) / (max_value - min_value)</span><br></pre></td></tr></table></figure></p>
<p>这就是归一化前和归一化后的区别：</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2018-01-01-01-24-51.png" alt="Screenshot from 2018-01-01 01-24-51"></p>
<p>为什么要进行归一化呢？这里引用这篇<a href="http://www.cnblogs.com/subsir/articles/4761140.html" target="_blank" rel="noopener">博客（数据标准化和归一化）</a>的原文：</p>
<blockquote>
<p>归一化是一种简化计算的方式，即将有量纲的表达式，经过变换，化为无量纲的表达式，成为纯量。归一化是为了加快训练网络的收敛性，可以不进行归一化处理</p>
<p>归一化的具体作用是归纳统一样本的统计分布性。归一化在0-1之间是统计的概率分布，归一化在-1–+1之间是统计的坐标分布。归一化有同一、统一和合一的意思。无论是为了建模还是为了计算，首先基本度量单位要同一，神经网络是以样本在事件中的统计分别几率来进行训练(概率计算)和预测的，归一化是同一在0-1之间的统计概率分布;SVM是以降维后线性划分距离来分类和仿真的，因此时空降维归一化是统一在-1–+1之间的统计坐标分布。</p>
</blockquote>
<p>现在，我们还需要将每一个数的标签单独提取出来，最为结果用于训练模型与模型预测结果比对：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">labels = data[:, <span class="number">1</span>]</span><br></pre></td></tr></table></figure></p>
<p>这样，我们的前期工作就准备完毕了</p>
<blockquote>
<p>Second Step</p>
</blockquote>
<p>这一步，我们就开始来构建我们的神经网络模型了，读者可以先去<a href="http://keras-cn.readthedocs.io/en/latest/" target="_blank" rel="noopener">keras中文</a>了解下tensorflow高级封装的深度学习框架，这个框架适合快速上手深度学习，但是还是要回归tensorflow。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense, Dropout</span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> load_data</span><br></pre></td></tr></table></figure></p>
<p>我们先导入相关的包，这是等等构建模型需要用到的，像全连接层：Dense、按一定概率随机断开神经元：Dropout、序贯模型：Sequential、绘图类：pyplot以及上一步我们的创建数据的包：load_data</p>
<p>先放上构建模型的代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">built_model</span><span class="params">()</span>:</span></span><br><span class="line">    model = Sequential()</span><br><span class="line">    <span class="comment"># first layers</span></span><br><span class="line">    model.add(Dense(units=<span class="number">256</span>,</span><br><span class="line">                    input_dim=<span class="number">2</span>,</span><br><span class="line">                           activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.5</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># second layers</span></span><br><span class="line">    model.add(Dense(units=<span class="number">128</span>,</span><br><span class="line">                    activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.5</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># third layers</span></span><br><span class="line">    model.add(Dense(units=<span class="number">1</span>,</span><br><span class="line">                    activation=<span class="string">'sigmoid'</span>))</span><br><span class="line"></span><br><span class="line">    model.compile(loss=<span class="string">'binary_crossentropy'</span>,</span><br><span class="line">                  optimizer=<span class="string">'adam'</span>,</span><br><span class="line">                  metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line">    model.summary()</span><br><span class="line">    <span class="keyword">return</span> model</span><br></pre></td></tr></table></figure></p>
<p>我们这个模型有三层神经网络——三个全连接层（Dense），每个全连接层加了Dropout层，Dense层的作用我在上一篇文章<a href="https://liaochuntao.wordpress.com/2017/12/27/%e8%ae%b0%e4%b8%80%e6%ac%a1%e7%ab%9e%e8%b5%9b%e9%a2%98%e7%9b%ae%e6%9c%89%e6%84%9f-%e5%9b%be%e5%83%8f%e8%af%86%e5%88%ab/" target="_blank" rel="noopener">《记一次竞赛题目有感——图像识别》</a> 中解释了下Dense层的作用，但是对于Dropout层的作用我只是说了下防止模型过拟合情况，那么怎么防止这个情况呢？看来还要从全连接层中说起，首先我先放上这个模型的图示以及之前没说过的全连接层的函数表达形式：</p>
<blockquote>
<p>学习奇偶数的模型图示</p>
</blockquote>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2017-12-31-19-21-00.png" alt="Screenshot from 2017-12-31 19-21-00"></p>
<blockquote>
<p>y = ∑i （wi * xi） + b  这个模型的第一、二层全连接层函数表达式</p>
</blockquote>
<p>由于图的问题，全连接层的神经元个数我并没有全部画出来来，因为全部画出来有点小多……这里就是一个简要的模型图，我们可以分清楚的看出我们的模型输入数据维度是二维的，表示我们对一个数字提取了两个特征，然后就是熟悉的全连接层的操作：每个神经元与下一层的所用神经元都有连接；接下来，我们看到在第一层与第二层的全连接层中，标注了一个记号——Dropout层作用的地方，没错，Dropout层作用的地方就是在每两层Dense层之间；为什么作用在这里？因为上一层的每个神经元与下一层的所有神经元都会连接，每个连接之间会有一个权值wi，连接数量越多，权值wi数量也会越多，而权值wi的取值其实就是这个模型的函数的待定系数取值，这个函数的含义其实就是去尽可能的描述一个数与奇偶性的关系，如果说权值wi越多，那么抓住的信息也就越多，就越能学习之间的关系，但是这不就是我们想要的吗？我们在把视线回到模型的开始之处——输入特征向量矩阵，整个模型的学习，是通过给的训练数据和对应答案来学习这二者之间的关系的，如果说我们的权值wi越多，其实学习到的关系是仅仅训练数据与答案之间的关系，相当于我们限定了自变量x的范围，我们在一个闭区间中让我们的模型去学习，那么最终，我们的模型学到的东西，也仅仅局限于这个闭区间中的内容，如果数据不在这个区间呢？那么模型就没办法处理了，这就是我们所说的模型过拟合问题，其原因就是全连接层之间神经元连接数太多导致权值wi数量也相应的增加。那么我们就想到能不能减少神经元之间的连接数量？这个工作的实现就是Dropout层来实现的，Dropout层的工作是一定几率的将某些神经元之间的连接断开（也就是让输入为0），这样我们就减少了权值wi的个数，也就一定程度上防止了我们的模型过拟合。</p>
<blockquote>
<p>最终完整代码</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense, Dropout</span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> load_data</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">built_model</span><span class="params">()</span>:</span></span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Dense(units=<span class="number">256</span>,</span><br><span class="line">                    input_dim=<span class="number">2</span>,</span><br><span class="line">                    activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.5</span>))</span><br><span class="line">    model.add(Dense(units=<span class="number">128</span>,</span><br><span class="line">                    activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.5</span>))</span><br><span class="line">    model.add(Dense(units=<span class="number">1</span>,</span><br><span class="line">                    activation=<span class="string">'sigmoid'</span>))</span><br><span class="line">    model.compile(loss=<span class="string">'binary_crossentropy'</span>,</span><br><span class="line">                  optimizer=<span class="string">'adam'</span>,</span><br><span class="line">                  metrics=[<span class="string">'accuracy'</span>])</span><br><span class="line">    model.summary()</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train_model</span><span class="params">(batch_size=<span class="number">32</span>, verbose=<span class="number">2</span>, validation_split=<span class="number">0.2</span>, model=None)</span>:</span></span><br><span class="line">    data, labels = load_data.load_data()</span><br><span class="line">    train_x, train_y = data[: int(len(data) * <span class="number">0.7</span>), <span class="number">0</span>: <span class="number">2</span>], labels[: int(len(labels) * <span class="number">0.7</span>)]</span><br><span class="line">    test_x, test_y = data[int(len(data) * <span class="number">0.7</span>): len(data), <span class="number">0</span>: <span class="number">2</span>], labels[int(len(labels) * <span class="number">0.7</span>): len(labels)]</span><br><span class="line">    <span class="keyword">if</span> model <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        model = built_model()</span><br><span class="line">        history = model.fit(train_x, train_y,</span><br><span class="line">                            batch_size=batch_size,</span><br><span class="line">                            epochs=<span class="number">10</span>,</span><br><span class="line">                            verbose=verbose,</span><br><span class="line">                            validation_split=validation_split)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"刻画损失函数的变化趋势"</span></span><br><span class="line">        plt.plot(history.history[<span class="string">'loss'</span>], label=<span class="string">'train'</span>)</span><br><span class="line">        plt.plot(history.history[<span class="string">'val_loss'</span>], label=<span class="string">'valid'</span>)</span><br><span class="line">        plt.legend()</span><br><span class="line">        plt.show()</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"模型构建成功，开始预测数据"</span></span><br><span class="line">        score = model.evaluate(test_x, test_y,</span><br><span class="line">                               batch_size=batch_size)</span><br><span class="line">        <span class="keyword">print</span> score</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"画图"</span></span><br><span class="line">        predicted = model.predict(test_x,</span><br><span class="line">                                  batch_size=batch_size,</span><br><span class="line">                                  verbose=<span class="number">0</span>)</span><br><span class="line">        rounded = [round(w) <span class="keyword">for</span> w <span class="keyword">in</span> predicted]</span><br><span class="line">        plt.scatter(test_y, list(range(len(test_y))), marker=<span class="string">'+'</span>)</span><br><span class="line">        plt.scatter(rounded, list(range(len(predicted))), marker=<span class="string">'*'</span>)</span><br><span class="line">        plt.show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    train_model()</span><br></pre></td></tr></table></figure>
<p>损失函数值的变化：</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/loss2.png" alt="loss"></p>
<blockquote>
<p>YouTube站点查看模型构建视频：</p>
</blockquote>
<p>[youtube <a href="https://www.youtube.com/watch?v=ZcS0lMsmKMY&amp;w=560&amp;h=315]" target="_blank" rel="noopener">https://www.youtube.com/watch?v=ZcS0lMsmKMY&amp;w=560&amp;h=315]</a></p>
<blockquote>
<p>哔哩哔哩站点查看模型构建视频：</p>
</blockquote>
<p><a href="https://www.bilibili.com/video/av17838797/" target="_blank" rel="noopener">https://www.bilibili.com/video/av17838797/</a></p>
<blockquote>
<p>源代码地址：</p>
</blockquote>
<p><a href="https://github.com/chuntaojun/Deeplearning/tree/master/Parity%20learning" target="_blank" rel="noopener">https://github.com/chuntaojun/Deeplearning/tree/master/Parity%20learning</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2017/12/27/deep_learning_1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/27/deep_learning_1/" class="post-title-link" itemprop="url">记一次竞赛题目有感——图像识别</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-12-27 03:07:37" itemprop="dateCreated datePublished" datetime="2017-12-27T03:07:37+08:00">2017-12-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/深度学习/" itemprop="url" rel="index"><span itemprop="name">深度学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>比赛连接 sofasofa.io</p>
</blockquote>
<p><a href="http://sofasofa.io/competition.php?id=6" target="_blank" rel="noopener">形状识别：是方还是圆</a></p>
<blockquote>
<p>我们给出四千张图像作为训练集。每个图像中只有一个图形，要么是圆形，要么是正方形。你的任务根据是根据这四千张图片训练出一个二元分类模型，并用它（不是用肉眼）在测试集上判断每个图像中的形状。</p>
</blockquote>
<blockquote>
<p>训练集中共有4000个灰度图像，预测集中有3550个灰度图像。每个图像中都会含有大量的噪点。<br>图像的分辨率为40x40，也就是40x40的矩阵，每个矩阵以行向量的形式被存放在train.csv和test.csv中。train.csv和test.csv中每行数据代表一个图像，也就是说每行都有1600个特征。</p>
</blockquote>
<p>竞赛题目</p>
<p>最近迷上了深度学习，毅然抛弃了曾经学习已久的Java-Web（当然也不是完全抛弃，只是不那么放精力去研究了，偶尔研究下怎么原生代码实现Spring功能）。言归正传，我今天讲讲如何用深度学习来识别图像中的方形和圆形吧。</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/square.jpg?w=300" alt="square.jpg"></p>
<p>先放上训练的图像，我们从图中是不是很容易就看出左上和下面的图片中存在方形，右上角的图片中存在圆形，对于我们人来说，这不是小case吗？确实，稍微懂事一点的孩子，稍微教下，孩子马上就能知道方形和圆形的区别，但是，我们现在需要教计算机去学习方形和圆形的区别，这怎么做到？如果在前几年，那么可以用机器学习的分类算法，对这些图片进行分类，但是这个算法可能十分复杂。但是如果采用深度学习来做图像识别，那么会非常的快将一个图像识别模型构造出来，当然，模型构造的好坏还是需要一定的练习，但是代码量相比传统的机器学习，可以说少的是很多了。</p>
<p>那么我们如何用深度学习来完成这个图像识别呢？题目中已经明确了每一张图片的特征维度是1600，并且已经帮我们处理为了一维数组，那么，首先我们可以考虑使用向前传播的神经网络来学习图片特征，利用数个全连接层（Dense，用于特征学习，层层推导特征向量，然后将特征映射到标签）和（全连接层数-1）层的Dropout层（去除模型过拟合），那么我们将这个神经网络图示就如下面的图：</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/u672au547du540du6587u4ef61.png" alt="u672au547du540du6587u4ef6.png"></p>
<p>那么全连接层是如何实现将特征向量映射到标签中的吗？首先，我们有维度为1600的关于图片特征的特征向量，这个就是整个神经网络的输入部分，然后，这个向量中的每一个值通过与全连接层中的所有神经元进行连接，怎么连接？每一个特征值与神经元之间的连接需要乘上一个权重wi，与权重进行相乘操作后产生的新数据作为该神经元的输入，然后在神经元内数据经过激活函数去线性之后将处理过后的数据往下一个神经元输入，就这样通过数层的神经网络层之后，最后一层全连接层会将上一个神经元输入的数据进行计算，得出一个估计答案，再把这个答案映射到标签空间中，与对应的标签进行比对，计算误差值，这就是全连接层的工作。这里有一个小小的难点，我们刚刚说的权重wi，这是怎么确定的？实际上，这个权重恰恰是整个神经网络所要学习的东西；我们说神经网络学习学什么？学的就是这个权重，那怎么学习呢？这里就要提到反向传播算法，我这里简要说下反向传播算法怎么去让神经网络学习权重：在最后一层全连接层中不是计算出了一个估计答案和与实际答案之间的误差吗？这个误差，就是重点，反向传播算法将这个误差带回到神经网络，通过误差去不断调整权重wi，知道这个误差在可以接受的范围内，于是，神经网络就学习到了东西——对于这个场景中整个神经网络适合的权重wi。</p>
<p>只用全连接层来做图片识别的最典型的就是tensorflow的入门教程——MNIST的手写字体图片的识别，<a href="https://www.tensorflow.org/get_started/mnist/beginners" target="_blank" rel="noopener">这个是tensorflow采用全连接层来实现的文章。</a></p>
<p>但是呢，经过人们发现，这种神经网络的学习能力还是那么稍微不如意，于是，又诞生了卷积神经网络，相比于全连接层的将一张图的所有特征向量一次性输入神经网络；卷积神经网络是将图片进行分块学习，学习每一块的特征，从这图片中的每一块提取价值信息，最后进行汇总，从而实现学习整张图片的信息，形象的来说，就是在我们看到一辆车时，我们大脑接收到这张图片，堆这张图片的每一部分进行信息提取：提取了轮子信息、提取了车门信息、提取了形状信息……这些信息综合到一起，哦，于是我们大脑得出一个结论——这是一辆车。那么卷积网络模型是怎么样的呢？看下图</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/e69caae591bde5908de69687e4bbb61.png" alt="未命名文件"></p>
<p>通过卷积操作对我们的图片进行特征的提取工作，提取方式不是对整张图进行特征提取，而是堆图中的一部分进行特征提取操作，然后通过最大值池化层进行计算，将该特征和区域的最大值作为抽样后的值，向下一个卷积层传递。这里可能会问，池化层具体有什么用呢？池化层的作用是为了在全连接层中，能够减少全连接的数量，全连接的数量下来了，参数（权重wi）个数也就下来了，而参数的个数与该神经网络是否过拟合是有一定联系的。</p>
<blockquote>
<p>现在讲讲我们如何解决这个题目：<br>题目所给的图片特征是一维的，也就是说将图片原来具有的长宽降维处理，但是，在我们构建的模型中，采用的2D卷积操作，因此我们需要将一维的进行升维操作，使的图片的长宽通过矩阵的shape体现出来，升维操作我们采用的是numpy的reshape操作</p>
</blockquote>
<pre><code>data = np.array([np.reshape(i, (40, 40)) for i in data])
</code></pre><blockquote>
<p>同时，2D卷积操作还有一个channel，就是颜色通道，所以，我们还需要对矩阵进行一次操作，由于是灰度图片，RGB颜色通道为1，所以我们再次用numpy的reshape进行操作<br>将矩阵重新塑形为 （40， 40， 1）的形状，以符合卷积神经网络的输入</p>
</blockquote>
<pre><code>data = np.array([np.reshape(i, (i.shape[0], i.shape[1], 1)) for i in data])
</code></pre><p>这样，我们就完成了神经网络输入数据的数据处理部分操作</p>
<blockquote>
<p>数据加载代码</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">FILE_PATH_train = <span class="string">"/media/chuntaojun/Mylinux/code/PythonProject/DeepingLearning/sofasofa/Prac_1/data/train.csv"</span></span><br><span class="line"></span><br><span class="line">FILE_PATH_test = <span class="string">"/media/chuntaojun/Mylinux/code/PythonProject/DeepingLearning/sofasofa/Prac_1/data/test.csv"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_train_test_data</span><span class="params">()</span>:</span></span><br><span class="line">    data_train = pd.read_csv(FILE_PATH_train)</span><br><span class="line">    data_test = pd.read_csv(FILE_PATH_test)</span><br><span class="line">    <span class="keyword">del</span> data_train[<span class="string">'id'</span>]</span><br><span class="line">    <span class="keyword">del</span> data_test[<span class="string">'id'</span>]</span><br><span class="line">    data_train = np.array(data_train.values)</span><br><span class="line">    np.random.shuffle(data_train)</span><br><span class="line">    labels = data_train[:, <span class="number">-1</span>]</span><br><span class="line">    data_test = np.array(data_test.values)</span><br><span class="line">    data, data_test = data_modify_suitable_train(data_train, <span class="keyword">True</span>), data_modify_suitable_train(np.array(data_test),<span class="keyword">False</span>)</span><br><span class="line">    train_x, test_x, train_y, test_y = train_test_split(data, labels, test_size=<span class="number">0.7</span>)</span><br><span class="line">    <span class="keyword">return</span> train_x, train_y, test_x, test_y, data_test</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_modify_suitable_train</span><span class="params">(data_set=None, type=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> data_set isnotNone:</span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">if</span> typeisTrue:</span><br><span class="line">            np.random.shuffle(data_set)</span><br><span class="line">            data = data_set[:, <span class="number">0</span>: data_set.shape[<span class="number">1</span>] - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data = data_set</span><br><span class="line">    data = np.array([np.reshape(i, (<span class="number">40</span>, <span class="number">40</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> data])</span><br><span class="line">    data = np.array([np.reshape(i, (i.shape[<span class="number">0</span>], i.shape[<span class="number">1</span>], <span class="number">1</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> data])</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    load_train_test_data()</span><br></pre></td></tr></table></figure>
<p>对于CNN模型构建部分，我们采用的keras深度学习框架，因此我们可以很快速的构建起CNN模型，通过Sequential()获取模型对象，然后通过mode.add()方法不断的为模型添加网络层：</p>
<ul>
<li>Convolution2D  ：2维卷积层</li>
<li>MaxPooling2D   ：与2维卷积层操作对应的2维池化层</li>
<li>Flatten                 ：从卷积层到全连接层，需要将矩阵维度降为一维</li>
<li>Dense                   ：全连接层，通过全连接层进行计算，然后将结果映射到标签空间</li>
<li>activation=’sigmoid’ ：因为这个图片识别其实就是二分类的操作，因此我们的激活函数采用sigmoid，这个函数了能够将结果映射到[0，1]区间，以0.5为阀值，进行二分类操作</li>
</ul>
<blockquote>
<p>CNN卷积神经网络模型构建代码</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras.callbacks <span class="keyword">import</span> TensorBoard</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense, Dropout, MaxPooling2D, Flatten, Convolution2D</span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras <span class="keyword">import</span> backend <span class="keyword">as</span> K</span><br><span class="line"><span class="keyword">import</span> load_data <span class="keyword">as</span> ld</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span><span class="params">(y_true, y_pred)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recall</span><span class="params">(y_true,y_pred)</span>:</span></span><br><span class="line">        true_positives = K.sum(K.round(K.clip(y_true * y_pred, <span class="number">0</span>, <span class="number">1</span>)))</span><br><span class="line">        possible_positives = K.sum(K.round(K.clip(y_true, <span class="number">0</span>, <span class="number">1</span>)))</span><br><span class="line">        recall = true_positives / (possible_positives + K.epsilon())</span><br><span class="line">        <span class="keyword">return</span> recall</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">precision</span><span class="params">(y_true,y_pred)</span>:</span></span><br><span class="line">        true_positives = K.sum(K.round(K.clip(y_true * y_pred, <span class="number">0</span>, <span class="number">1</span>)))</span><br><span class="line">        predicted_positives = K.sum(K.round(K.clip(y_pred, <span class="number">0</span>, <span class="number">1</span>)))</span><br><span class="line">        precision = true_positives / (predicted_positives + K.epsilon())</span><br><span class="line">        <span class="keyword">return</span> precision</span><br><span class="line">        precision = precision(y_true, y_pred)</span><br><span class="line">        recall = recall(y_true, y_pred)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>* ((precision * recall) / (precision + recall))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">built_model</span><span class="params">()</span>:</span></span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Convolution2D(filters=<span class="number">8</span>,</span><br><span class="line">                            kernel_size=(<span class="number">5</span>, <span class="number">5</span>),</span><br><span class="line">                            input_shape=(<span class="number">40</span>, <span class="number">40</span>, <span class="number">1</span>),</span><br><span class="line">                            activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Convolution2D(filters=<span class="number">16</span>,</span><br><span class="line">                            kernel_size=(<span class="number">3</span>, <span class="number">3</span>),</span><br><span class="line">                            activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)))</span><br><span class="line">    model.add(Convolution2D(filters=<span class="number">16</span>,</span><br><span class="line">                            kernel_size=(<span class="number">3</span>, <span class="number">3</span>),</span><br><span class="line">                            activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)))</span><br><span class="line">    model.add(Flatten())</span><br><span class="line">    model.add(Dense(units=<span class="number">128</span>,</span><br><span class="line">                    activation=<span class="string">'relu'</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.5</span>))</span><br><span class="line">    model.add(Dense(units=<span class="number">1</span>,</span><br><span class="line">                    activation=<span class="string">'sigmoid'</span>))</span><br><span class="line">    model.compile(loss=<span class="string">'binary_crossentropy'</span>,</span><br><span class="line">                  optimizer=<span class="string">'adam'</span>,</span><br><span class="line">                  metrics=[<span class="string">'accuracy'</span>, f1])</span><br><span class="line">    model.summary()</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train_model</span><span class="params">(batch_size=<span class="number">64</span>, epochs=<span class="number">20</span>, model=None)</span>:</span></span><br><span class="line">    train_x, train_y, test_x, test_y, t = ld.load_train_test_data()</span><br><span class="line">    <span class="keyword">if</span> model <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        model = built_model()</span><br><span class="line">        history = model.fit(train_x, train_y,</span><br><span class="line">                            batch_size=batch_size,</span><br><span class="line">                            epochs=epochs,</span><br><span class="line">                            verbose=<span class="number">2</span>,</span><br><span class="line">                            validation_split=<span class="number">0.1</span>)</span><br><span class="line">    <span class="keyword">print</span><span class="string">"刻画损失函数在训练与验证集的变化"</span></span><br><span class="line">    plt.plot(history.history[<span class="string">'loss'</span>], label=<span class="string">'train'</span>)</span><br><span class="line">    plt.plot(history.history[<span class="string">'val_loss'</span>], label=<span class="string">'valid'</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.show()</span><br><span class="line">    predicted = model.predict(t,</span><br><span class="line">                              batch_size=batch_size,</span><br><span class="line">                              verbose=<span class="number">1</span>)</span><br><span class="line">    predicted = np.array([round(w) <span class="keyword">for</span> w <span class="keyword">in</span> predicted])</span><br><span class="line">    score = model.evaluate(test_x, test_y,</span><br><span class="line">                           batch_size=batch_size)</span><br><span class="line">    <span class="keyword">print</span> score</span><br><span class="line">    <span class="keyword">print</span><span class="string">"刻画预测结果与测试集结果"</span></span><br><span class="line">    model.save(<span class="string">'my_model.h5'</span>)</span><br><span class="line">    <span class="keyword">return</span> predicted</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    predicted = train_model()</span><br><span class="line">    num = <span class="number">4000</span></span><br><span class="line">    csvFile = open(<span class="string">'test_y.csv'</span>, <span class="string">'w'</span>)</span><br><span class="line">    write = csv.writer(csvFile)</span><br><span class="line">    write.writerow([<span class="string">'id'</span>,<span class="string">'y'</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> predicted:</span><br><span class="line">        write.writerow([num,int(i)])</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">print</span> predicted</span><br></pre></td></tr></table></figure>
<p>然后通过训练我们的神经网络，得到了一个损失函数值在训练过程的变化图（损失函数就是神经网络模型优化的目标）</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/loss1.png" alt="loss.png"></p>
<p>最后，将我们模型预测的结果提交到sofasofa.io竞赛平台对应的题目中，看看排名成绩</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2017-12-27-03-01-10.png" alt="Screenshot from 2017-12-27 03-01-10"></p>
<p>可以看出我们的模型构建的还是蛮不错的（第二个是我）</p>
<blockquote>
<p>YouTube视频展示模型构建情况</p>
</blockquote>
<p>[youtube <a href="https://www.youtube.com/watch?v=lYVTVgtSTnw&amp;w=560&amp;h=315]" target="_blank" rel="noopener">https://www.youtube.com/watch?v=lYVTVgtSTnw&amp;w=560&amp;h=315]</a></p>
<blockquote>
<p>哔哩哔哩站点展示模型构建情况</p>
</blockquote>
<p><a href="https://www.bilibili.com/video/av17661456/" target="_blank" rel="noopener">https://www.bilibili.com/video/av17661456/</a></p>
<blockquote>
<p>项目代码</p>
</blockquote>
<p><a href="https://github.com/chuntaojun/Deeplearning/tree/master/Prac_1" target="_blank" rel="noopener">https://github.com/chuntaojun/Deeplearning/tree/master/Prac_1</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2017/12/27/data_struct_15/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/27/data_struct_15/" class="post-title-link" itemprop="url">排序算法三之快速排序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-12-27 01:07:14" itemprop="dateCreated datePublished" datetime="2017-12-27T01:07:14+08:00">2017-12-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天，我们要讲最后一个排序内容——快速排序，快速排序目前是用的最多的排序方法，在<a href="https://www.liaochuntao.cn/2017/12/16/data_struct_12/">排序算法一</a></p>
<p>中我们有一张图，上面记录了快速排序的时间复杂度为O（NlogN），并且快速排序和归并排序一样是一种分治的递归算法。</p>
<p>快速排序算法其实总的来说由四个步骤组成：</p>
<ol>
<li>判断元素个数，个数为0 or 1 直接返回；</li>
<li>从元素数组中取出一个数作为枢纽元；</li>
<li>讲初枢纽元外的元素进行分类，枢纽元左边的为小于枢纽元的数，枢纽元右边为大于枢纽元的数，如果等于枢纽元呢？左右两边都可以；</li>
<li>对枢纽元两边的元素数组分别执行3步骤，这样递归下去。<br>这里在第三步中，我们有一个选取枢纽元的步骤，那么我们是怎么选取枢纽元的呢？选取枢纽元的方法采用了三数中值取法；所谓三数中值取法就是我们取元素数组的第一个元素，最后一个元素和处于数组中间的元素[（left + right）/ 2]，然后，我们对这三个进行排序，选择三个数中大小处于中间的数，假设我们有：8、1、4、9、6、3、5、2、7、0，第一个元素和最后一个元素分别是8和0，数组中间的元素是6，我们对这三个数排序=&gt;0&lt;6&lt;8，因此我们选择6作为枢纽元</li>
</ol>
<p>用一张图来描述下快速排序的步骤：</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2017-12-27-00-44-21.png" alt="Screenshot from 2017-12-27 00-44-21.png"></p>
<p>接下来就是快速排序的代码：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ElementType <span class="title">Median3</span><span class="params">(ElementType A[], <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> center =(left + right)/<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span>(A[left]&gt; A[center])</span><br><span class="line">        Swap(&amp;A[left],&amp;A[center]);</span><br><span class="line">    <span class="keyword">if</span>(A[left]&gt; A[right])</span><br><span class="line">        Swap(&amp;A[left],&amp;A[right]);</span><br><span class="line">    <span class="keyword">if</span>(A[center]&gt; A[right])</span><br><span class="line">        Swap(&amp;A[center],&amp;A[right]);</span><br><span class="line">    Swap(&amp;A[center],&amp;A[right <span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">return</span> A[right <span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Qsort</span><span class="params">(ElementType A[], <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    ElementType pivot;</span><br><span class="line">    pivot = Median3(A, left, right);</span><br><span class="line">    i = left;</span><br><span class="line">    j = right - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span>(A[++i]&lt; pivot)&#123;&#125;</span><br><span class="line">        <span class="keyword">while</span>(A[--j]&gt; pivot)&#123;&#125;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; j)</span><br><span class="line">            Swap(&amp;A[i],&amp;A[j])</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Swap(&amp;A[i],&amp;A[right <span class="number">-1</span>]);</span><br><span class="line">    Qsort(A, left, i <span class="number">-1</span>)</span><br><span class="line">    Qsort(A, i +<span class="number">1</span>, right)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2017/12/21/data_struct_14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/21/data_struct_14/" class="post-title-link" itemprop="url">排序算法二之堆排序与归并排序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-12-21 14:52:43" itemprop="dateCreated datePublished" datetime="2017-12-21T14:52:43+08:00">2017-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据结构/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h4><p>还记得上一次的数据结构文章——<a href="https://liaochuntao.wordpress.com/2017/12/18/%e6%8e%92%e5%ba%8f%e7%ae%97%e6%b3%95%e4%ba%8c%e4%b9%8b%e5%bd%92%e5%b9%b6%e6%8e%92%e5%ba%8f%e4%b8%8e%e5%a0%86%e6%8e%92%e5%ba%8f/" target="_blank" rel="noopener">优先队列（堆）</a></p>
<p>吗？在那篇文章中，我们提到了大顶堆与小顶堆，并且说了优先队列出对顺序和元素的优先级有关系，今天我们说的两个算法中的堆排序，就是从优先队列而来的，既然优先队列每次出队的元素都是按元素优先级来的，那么，在排序算法中，我们不是可以将元素优先级设置为元素的大小吗——这就是我们上篇文章说提到的大顶堆与小顶堆。那么，堆排序实际很快就能写出来了，只是稍微改变而已，在例程中我们做的是大顶堆操作，然后每一次DeleteMax，就是将堆中最顶上的元素和最后一个元素进行交换，等到执行N - 1次后，我们发现实现堆结构的数组内的元素已经按从小到大的顺序排好了，具体过程如下：</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/u672au547du540du6587u4ef6.png" alt="u672au547du540du6587u4ef6.png"></p>
<blockquote>
<p>堆排序代码</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LeftChild(i) (2 * (i) + 1)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrecDown</span><span class="params">(ElementType A[], <span class="keyword">int</span> i, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> child;</span><br><span class="line">    ElementType tmp;</span><br><span class="line">    <span class="keyword">for</span>(tmp = A[i];LeftChild(i)&lt; N; i = child)&#123;</span><br><span class="line">        child = LeftChild(i);</span><br><span class="line">    <span class="keyword">if</span>(child != N <span class="number">-1</span>&amp;&amp; A[child +<span class="number">1</span>]&gt; A[child])</span><br><span class="line">        child += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(tmp &lt; A[child])</span><br><span class="line">        A[i] = A[child]</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    A[i] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> *b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp =*a;</span><br><span class="line">    *a =*b;</span><br><span class="line">    *b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HeapSort</span><span class="params">(ElementType A[], <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = N /<span class="number">2</span>; i &gt;=<span class="number">0</span>; i--)&#123;</span><br><span class="line">        PrecDown(A, i, N);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i = N <span class="number">-1</span>; i &gt;<span class="number">0</span>; i --)&#123;</span><br><span class="line">        Swap(&amp;A[<span class="number">0</span>],&amp;A[i]);</span><br><span class="line">        PrecDown(A,<span class="number">0</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h4><p>之前的一篇<a href="https://liaochuntao.wordpress.com/2017/12/16/%e6%8e%92%e5%ba%8f%e7%ae%97%e6%b3%95%e4%b8%80%e4%b9%8b%e6%8f%92%e5%85%a5%e6%8e%92%e5%ba%8f%e4%b8%8e%e5%b8%8c%e5%b0%94%e6%8e%92%e5%ba%8f/" target="_blank" rel="noopener">排序算法一之插入排序和希尔排序</a>，我们介绍了排序算法的稳定性和那些排序算法是稳定的，这不，这次讲的归并排序，就是一个稳定的排序算法，现在我们来了解了解归并算法吧。</p>
<p>归并排序，实际上是合并两个已经按相同排序规则排序好的表，将它们合并到第三张表里面，因此，只需要一趟排序就可以完成。过程如下：我们创建第三张表C，然后开始对第一张表A、第二张表B的元素两两比较，首先比较第一张表和第二张表的首元素A1、B1，将两个中较小的（或较大）放入C表中成为C表的第一个元素C1，假设A1&lt;B1，我们把A1放入C表的第一个元素位置，B1元素不放入C表，而是接着和A1的下一个元素进行比较。接着，我们再把A2元素和刚刚的B1元素进行比较，重复A1与B1比较的步骤……知道其中某一张表的所有元素先放入C表后，我们在把另一张表的剩余所有元素直接按序接在C表中当前最后一个元素的后面，接下来我们有图来展示下过程：</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2017-12-20-23-49-07.png" alt="Screenshot from 2017-12-20 23-49-07.png"></p>
<p>现在我们就给出代码吧：<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MSort</span><span class="params">(ElementType A[], ElementType tmpArray[], <span class="keyword">int</span> Left, <span class="keyword">int</span> Right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> center;</span><br><span class="line">    <span class="keyword">if</span>(Left &lt; Right) &#123;</span><br><span class="line">        center = (Left + Right) / <span class="number">2</span>;</span><br><span class="line">        MSort(A, tmpArray, Left, center);</span><br><span class="line">        MSort(A, tmpArray, center +<span class="number">1</span>, Right);</span><br><span class="line">        Merge(A, tmpArray, Left, center +<span class="number">1</span>, Right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MergeSort</span><span class="params">(ElementType A[], <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">    ElementType *tmpArray;</span><br><span class="line">    tmpArray = <span class="built_in">malloc</span>(N * <span class="keyword">sizeof</span>(ElementType));</span><br><span class="line">    <span class="keyword">if</span>(tmpArray !=<span class="literal">NULL</span>)&#123;</span><br><span class="line">        MSort(A, tmpArray,<span class="number">0</span>, N <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">free</span>(tmpArray);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Merge</span><span class="params">(ElementType A[], ElementType tmpArray[], <span class="keyword">int</span> Lpos, <span class="keyword">int</span> Rpos, <span class="keyword">int</span> RightEnd)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, LeftEnd, NumElements, TmpPos;</span><br><span class="line">    LeftEnd = Rpos - <span class="number">1</span>;</span><br><span class="line">    TmpPos = Lpos;</span><br><span class="line">    NumElements = RightEnd - Lpos + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(Lpos &lt;= LeftEnd &amp;&amp; Rpos &lt;= RightEnd) &#123;</span><br><span class="line">        <span class="keyword">if</span>(A[Lpos]&lt;= A[Rpos])</span><br><span class="line">            tmpArray[TmpPos ++] = A[Lpos ++];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            tmpArray[TmpPos ++] = A[Rpos ++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(Lpos &lt;= LeftEnd)</span><br><span class="line">        tmpArray[TmpPos ++] = A[Lpos ++];</span><br><span class="line">    <span class="keyword">while</span>(Rpos &lt;= RightEnd)</span><br><span class="line">        tmpArray[TmpPos ++] = A[Rpos ++];</span><br><span class="line">    <span class="keyword">for</span>(i =<span class="number">0</span>; i &lt; NumElements; i ++, RightEnd --)</span><br><span class="line">        A[RightEnd] = tmpArray[RightEnd];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="default">
    <link itemprop="mainEntityOfPage" href="https://www.liaochuntao.cn/2017/12/20/java_web_5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liaochuntao">
      <meta itemprop="description" content="励志成为一位大佬">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春少 Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/20/java_web_5/" class="post-title-link" itemprop="url">java注解原生模仿@ModelAttribute功能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-12-20 00:00:01" itemprop="dateCreated datePublished" datetime="2017-12-20T00:00:01+08:00">2017-12-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-02-25 12:20:08" itemprop="dateModified" datetime="2020-02-25T12:20:08+08:00">2020-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java-web/" itemprop="url" rel="index"><span itemprop="name">java-web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2017-12-19-22-46-251.png" alt="Screenshot from 2017-12-19 22-46-25.png"></p>
<p>对于做Java Web开发的人来说，肯定都遇到过表单提交，并且，每一个表单的提交后面至少跟一个对象，比如说一个登录的表单，后面一定跟着一个登录对象（也有可能直接就是User对象），既然有对象，势必需要数据绑定到对象的属性了，在原生的Servlet开发中，我们用HttpServletRequest对象的getParamter（String s）的方法去获取表单中对应name属性的值；如果是使用Srping框架的，那么一定用过@ModelAttribute这个注解来实现表单的数据绑定。原生的Servlet方法我们就不讲了，这个太easy了，今天我们要来说的是如何原生实现@ModelAttribute注解的数据绑定功能</p>
<p>首先，我们先创建两个Java文件，类型为Annotation</p>
<p><img src="https://liaochuntao.files.wordpress.com/2017/12/screenshot-from-2017-12-19-22-48-121.png" alt="Screenshot from 2017-12-19 22-48-12.png"></p>
<p>一个我们命名为SetMethod，另一个命名为GetMethod，代码如下：</p>
<blockquote>
<p>GetMethod 方法</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> GetMethod &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>SetMethod 方法</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SetMethod &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>之所以定义SetMethod和GetMethod，是因为在Java Web开发中，我们为实体对象的属性设置了get和set方法用于获取实体的属性。现在，我们来说说这两个注解中的@Target、@Retention、@Document是什么意思：</p>
<ul>
<li>@Target ：指示注释类型适用的上下文，在这里，我们设定适用的上下文为方法——Method</li>
<li>@Retention：指示要注释具有注释类型的注释的保留时间。 如果注释类型声明中没有保留注释，则保留策略默认为<code>RetentionPolicy.CLASS</code> 。保留元注释仅在元注释类型直接用于注释时才起作用。 如果元注释类型用作另一注释类型的成员类型，则它不起作用。在这里，我们将注解的保留时间为运行时</li>
<li>@Document：表示具有类型的注释默认情况下由javadoc和类似工具记录<br>现在，我们成功的写了两个annotation——SetMethod 和 GetMethod，但是才一个方法呢？</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">value</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p>别小看这个方法，在GetMethod类中，我们这个方法通过GetMethod（String s）可以直接获取对象的属性值，String s的值就是对象过的属性名；在SetMethod类中，我们可以通过SetMethod（String s）来为你的set方法进行注解，而String s的值就是对象属性名，就这样，我们轻松的实现了数据绑定的前期工作；使用这两个方法如下：</p>
<blockquote>
<p>GetMethod、SetMethod使用方法</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.work.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String role;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String link;</span><br><span class="line">    <span class="keyword">private</span> String adress;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String depart;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMethod</span>(<span class="string">"username"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SetMethod</span>(<span class="string">"username"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMethod</span>(<span class="string">"password"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SetMethod</span>(<span class="string">"password"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRole</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> role;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SetMethod</span>(<span class="string">"role"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRole</span><span class="params">(String role)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.role = role;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLink</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> link;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLink</span><span class="params">(String link)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.link = link;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAdress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> adress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SetMethod</span>(<span class="string">"address"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAdress</span><span class="params">(String adress)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.adress = adress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SetMethod</span>(<span class="string">"birthday"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDepart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> depart;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SetMethod</span>(<span class="string">"depart"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDepart</span><span class="params">(String depart)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.depart = depart;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"username='"</span> + username + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", password='"</span> + password + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", role='"</span> + role + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", id="</span> + id +</span><br><span class="line">                <span class="string">", link='"</span> + link + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", adress='"</span> + adress + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", birthday="</span> + birthday +</span><br><span class="line">                <span class="string">", depart='"</span> + depart + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（这里给个小建议，为你的每一个对象都生成toString方法，这会为后期调试提供巨大便利）</p>
<p>现在，我们完成了百分之五十的工作，那么，怎么实现从HttpServletRequest对象将表单数据绑定到我们定义的对象中呢？我们还需要创建一个类，就叫做DataBind吧，先附上代码：</p>
<blockquote>
<p>数据绑定代码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.work.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Type;</span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> chuntaojun</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataBind</span>&amp;<span class="title">lt</span></span>;T&amp;gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">Request2Bean</span><span class="params">(HttpServletRequest request, Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (object == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Method[] methods = object.getClass().getMethods();</span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            <span class="keyword">if</span> (method.isAnnotationPresent(SetMethod.class)) &#123;</span><br><span class="line">                SetMethod sm = method.getAnnotation(SetMethod.class);</span><br><span class="line">                String filedName = sm.value();</span><br><span class="line">                Object fieldValue = request.getParameter(filedName);</span><br><span class="line">                Type[] params = method.getGenericParameterTypes();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (params[<span class="number">0</span>].getTypeName().contains(<span class="string">"Date"</span>)) &#123;</span><br><span class="line">                        DateFormat fmt = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">                        fieldValue = fmt.parse((String) fieldValue);</span><br><span class="line">                    &#125;</span><br><span class="line">                    method.invoke(object, fieldValue);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们在这个DataBind类中写了一个方法——Request2Bean，这个方法里面有两个参数，一个是HttpServletRequest，另一个是我们Object；我们都过Java提供的反射机制，获取Object对象的所有方法<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Method[] methods = object.getClass().getMethods();</span><br></pre></td></tr></table></figure></p>
<p>然后，我们遍历方法数组，在循环中，首先我们先判断这个方法是后被SetMethod这个注解作用了，如果是，我们就获取这个SetMethod这个对象实例，并获取SetMethod（String s）中s的值<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">method.isAnnotationPresent(SetMethod.class)</span><br><span class="line">SetMethod sm = method.getAnnotation(SetMethod.class);</span><br><span class="line">String filedName = sm.value();</span><br></pre></td></tr></table></figure></p>
<p>这个时候，我们通过fileName这个String对象从HttpServletRequest对象的getParamter方法取值<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object fieldValue = request.getParameter(filedName);</span><br></pre></td></tr></table></figure></p>
<p>由于我们的User对象中有Date对象，如果我们直接<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">method.invoke(object, fieldValue);</span><br></pre></td></tr></table></figure></p>
<p>会直接报 IllegalAccessException 错误，因为我们的getParamter方法返回的是一个String类型的对象，因此，我们还需要对方法中的参数类型做一个判断，在数据绑定的时候进行数据类型转换：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Type[] params = method.getGenericParameterTypes();</span><br></pre></td></tr></table></figure></p>
<p>这样我们就获取了方法中所有参数的类型，接着，我们获取参数类型的name，进行字符串的比较来实现数据类型的手动转换：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (params[<span class="number">0</span>].getTypeName().contains(<span class="string">"Date"</span>)) &#123;</span><br><span class="line">    DateFormat fmt = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">    fieldValue = fmt.parse((String) fieldValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>随后，我们只要调用<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">method.invoke(object, fieldValue);</span><br></pre></td></tr></table></figure></p>
<p>就可以完成set方法的调用，将表单的value绑定到我们的User对象属性。那么如何使用？这个就很简单啦，就像下面这样调用即可：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user = (User) Request2Bean(request, <span class="keyword">new</span> User());</span><br></pre></td></tr></table></figure></p>
<p>我们通过视频来看看效果吧！</p>
<blockquote>
<p>YouTube 站点</p>
</blockquote>
<p>[youtube <a href="https://www.youtube.com/watch?v=Ze2_GJvrF3U&amp;w=560&amp;h=315]" target="_blank" rel="noopener">https://www.youtube.com/watch?v=Ze2_GJvrF3U&amp;w=560&amp;h=315]</a></p>
<blockquote>
<p>哔哩哔哩站点</p>
</blockquote>
<p><a href="https://www.bilibili.com/video/av17431081/" target="_blank" rel="noopener">https://www.bilibili.com/video/av17431081/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">liaochuntao</p>
  <div class="site-description" itemprop="description">励志成为一位大佬</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">118</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/chuntaojun" title="GitHub → https://github.com/chuntaojun" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lessspring@outlook.com" title="E-Mail → mailto:lessspring@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liaochuntao</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"left","hOffset":0,"vOffset":-50},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"tagMode":false});</script></body>
</html>
